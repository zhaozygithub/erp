<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" http-equiv="X-UA-Compatible" content="IE=edge">
<title>dlcat index</title>
<script type="text/javascript" src='#assets("/assets/assets.jjs")'></script>
<script type="text/javascript" src='/js/jsUtil.js'></script>
<script src="js/bootstrap-3.3.7-dist/js/bootstrap.min.js"></script>
<link href="js/bootstrap-3.3.7-dist/css/bootstrap.min.css"
	rel="stylesheet">
<link href="css/index.css" rel="stylesheet">
</head>
<body>
	<div class="container-fluid">
		<div class="row">
			<div class="content-box clearfix col-lg-12">
				<div class="row">
					<div class="slider-left">
						<div>
							<a href="#"><img alt="logo图片" src="images/logo10.png"></a>
						</div>
						<div id="myTabContent" class="tab-content">
							#for(first :session.menuTree.children)

							<div class="tab-pane fade in" id="#(first.id)">

								#for(sec : first.children??)
								<ul class="list-unstyled">

									#for(third:sec.children??) #set(level = third.level) #set(size
									= for.size) #end #if(size&&level==3)
									<li class="dropdown level2">
										<button type="button" class="btn dropdown-toggle l2menubutton"
											id="dropdownMenu1" data-toggle="dropdown"
											onclick="$('#secName').text('>#(sec.name??)');$('#thirdName').text('')"
											style="width: 180px; height: 54px; color: #fff; background-color: transparent !important; border: none; font-size: 16px;">
											<a href="##(sec.id ??)">#(sec.name??)</a> <b class="down-up"><img
												class="down-up-img" alt="向上箭头" src="images/up.png"></b> <b
												class="down-down"><img class="down-down-img" alt="向下箭头"
												src="images/down.png"></b>
										</button>

										<ul class="dropdown-menu" role="menu"
											aria-labelledby="myTabDrop1">

											#for(third:sec.children??)
											<li class='level3'><a id="#(third.id??)" class="hs" href="#"
												rel="#(third.url??)" tabindex="-1" data-toggle="tab"
												onclick="$('#thirdName').text('>#(third.name??)')">#(third.name??)</a><b
												class="triangle-box"><img alt="三角"
													src="images/triangle.png"></b></li> #end
										</ul>
									</li> #set(size = null) #else
									<li class="menu-li level2">
									<button type="button" class="btn dropdown-toggle secbtn menu-only l2menuonly" data-toggle="dropdown"
											onclick="$('#secName').text('>#(sec.name??)');$('#thirdName').text('')"
											style="width: 180px; height: 54px; color: #fff; background-color: transparent !important; border: none; font-size: 16px;">
											<a href="#" id="#(sec.id)" data-toggle="tab"
												rel="#(sec.url??)">#(sec.name??)</a>
										</button></li> #end
								</ul>

								#end
							</div>
							#end


						</div>
					</div>

					<div class="col-lg-12 slider-right">
						<div class="pull-left col-lg-8">
							<ul id="myTab" class="nav nav-tabs list-unstyled">
								#for(first :session.menuTree.children)
								<li><a href="##(first.id)" data-toggle="tab" onclick="$('#firstName').text('#(first.name??)');$('#secName').text('');$('#thirdName').text('')">#(first.name??)</a></li>
								#end
							</ul>
						</div>
						<div class="pull-right">
							<div class="media pull-left">
								<a class="pull-left" href="#"> <img class="media-object"
									src="images/people.png" alt="用户头像">
								</a>
								<div class="media-body">
									<h4 class="media-heading">#(session.user.name)</h4>
								</div>
							</div>
							<div class="pull-right slider-media-right">
								<a class="set-a"  href="/set" data-toggle="modal" data-target="#mymodal1" data-backdrop="static">
									<img class="hover-a" alt="设置图片" src="images/set5.png">
									<img class="hover-b" alt="设置图片" src="images/set4.png">
								</a>
								<a class="news-a">
									<img class="hover-a" alt="消息图片" src="images/news6.png">
									<img class="hover-b" alt="消息图片" src="images/news5.png">
								</a>
								<a href="/doExit" class="close-a">
									<img class="hover-a" alt="退出图片" src="images/exit5.png">
									<img class="hover-b" alt="退出图片" src="images/exit6.png">
								</a>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- 消息框 -->
			<div class="news-body"></div>
			<div class="news-box">
				<div class="news-box-before"></div>
				<!-- 消息统计总数 如有更多，相加 -->
				<div class="news-box-header"><i></i><span style="color:red;font-size:16px;padding-left:10px;">#(message.flowcount ??)</span>条通知</div>
				<ul class="list-unstyled">
				    <li class="clearfix">
				    	<div class="pull-left">待处理流程</div>
				    	<div class="pull-right">+#(message.flowcount ??)</div>
				    </li>
				</ul>
				<div class="text-center news-more"><a href="#" onclick="$('#firstName').text('所有通知');$('#secName').text('');$('#thirdName').text('')">查看所有通知 ></a></div>
			</div>
            <!-- 部门位置 -->
			<div class="pull-right" style="margin-right:20px;"> 
				<label class="position-label">当前部门职位：#(orgName ??) > #(roleName ??)</label>
			</div>
			<!-- 当前位置 -->
			<div class="pull-left" style="margin-left: 200px;"> 
            <label class="position-label" id="firstName">控制台 </label>
            <label class="position-label" id="secName">>首页 </label>
            <label class="position-label" id="thirdName"></label>
            </div>	
		</div>
	</div>
		
	<!-- 模态弹出窗内容 -->
	<div class="modal" id="mymodal1" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
	<span style="font-family: arial, 宋体, sans-serif, tahoma, 'Microsoft YaHei'; font-size: 14px; line-height: 24px;">>  
		<div class="modal-dialog" style="    position: absolute;left: 50%;top: 50%;margin-left: -300px;margin-top: -258px;">
			<div class="modal-content">                          
            </div>            
		</div>
	</div>




	<div class="container-fluid body-box">
		<ul id="myTabs" class="nav nav-tabs body-tabs">
	        <!-- <li class="active"><a href="#examine" data-toggle="tab" class="text-muted btn">审核列表</a></li>
	        <li><a href="#examineDone" data-toggle="tab" class="text-muted btn">已审核</a></li>  -->
	    </ul>
	    <div id="myTabContents" class="tab-content body-box-tab-content">
	        <div class="tab-pane fade in active">
				<div class="row" id="box" style="margin-left: 0;">
					<iframe src="" style="width: 100%; background-color: #fff;"
						frameborder="no" border="0" framespacing="0"> </iframe>
				</div>
			</div>
	       
	    </div>             		
	</div>
	
	 
	
	<script type="text/javascript">
		$(function() {
			
			function getUrl(link,id) {
				var url;
				if (link == "") {
					url = "";
				} else {
					if (link.endWith("-")) {
						url = link + id;
					} else {
						url = link + "/" + id;
					}
				}
				return url;
			}
			
			
			function getTabs(id) {
				$.ajax({
							type : "POST",
							url : "/login/getTabsById/" + id,
							success : function(tabs) {
								//debugger;
								$("#myTabs").empty();
								if (tabs.length > 0) {
									for (var i = 0; i < tabs.length; i++) {
										$("#myTabs").append(
												'<li class="fourMenu" id="'+tabs[i].id+'" url="'+tabs[i].url+'"><a data-toggle="tab" class="text-muted btn">'
														+ tabs[i].name
														+ '</a></li>');
									}
									var height=$(window).height() - 149;
									$("iframe").attr("src",getUrl(tabs[0].url, tabs[0].id));
									$("iframe").css("height",height);
									$("#myTabs li:first-child").addClass("active");
									
									//tab事件
									$(".fourMenu").click(function() {
										var id = $(this).attr("id");
										var url = $(this).attr("url");
										$("iframe").attr("src",getUrl(url, id));
									});

								}

							}
						});
			}
			
			//初始化首页tabs
			getTabs(7);
			 
			 //三级菜单事件
			  $(".hs").click(function () {
				var id=$(this).attr("id");
				getTabs(id);
			  
			 });
			 
			 
			 //点击二级菜单事件
			  $(".secbtn").click(function () {
				 // debugger;
				var id=$(this).children().first().attr("id");
				getTabs(id);
			 });
			
		$(window).resize(function() {  
				var height = $(this).height();  
				 $("iframe").css("height",height-149); 
		});
	
		//首页的背景处于活动状态
		$("#myTabContent .tab-pane:first-child ul:first-child li:first-child").css("background-color","#d38606");

		$("#myTabContent div:first-child").addClass("active");
		$("#myTab li:first-child").addClass("active");

		//左侧栏按钮下拉控制，此段JS删除会用下拉菜单插件效果

		//无子菜单的二级菜单
		$('.l2menuonly').click(function(){
			closel3menu(this);
			$(this).parent().css('background','#d38606');
		});
		function closel3menu(node){
			$('.level2').css('background','');
			$("b.down-up").css("display", "none");
			$("b.down-down").css("display", "block");
			$('.level3').parent().css("display", "none");
			$('.level3').find('a.hs').css('color','');
			$('b.triangle-box').css('display','none');
		}
		 //有子菜单的二级菜单  
		 $("b.down-up").css("display", "none");
		 $("b.down-down").css("display", "block");
		 $('.l2menubutton').click(function(){
				//console.log(this); 
				if($(this).parent().css('background-color')!='#d38606'&& $(this).parent().css('background-color')!='rgb(211, 134, 6)'){
					$(this).parent().css('background','#d38606');
					$(this).parent().find('ul').css('display','block');
					$(this).find("b.down-up").css("display", "block");
					$(this).find("b.down-down").css("display", "none");
					
				}
				else{
					$(this).parent().css('background','');
					$(this).parent().find('ul').css('display','none');
					$(this).find("b.down-up").css("display", "none");
					$(this).find("b.down-down").css("display", "block");
				}
			});
			
		//三级菜单 
		function showdown(node){
			$('b.down-down').css('display','block');
			$('b.down-up').css('display','none');
			$(node).parent().siblings('button').find('b.down-up').css('display','block');
			$(node).parent().siblings('button').find('b.down-down').css('display','none');
		}
		$(".level3").click(function(){
			$('.level2 ul').css('display','none');
			$('.level2').css('background','');
			showdown(this);
			$('a.hs').css('color','');
			$('b.triangle-box').css('display','none');
			$(this).parent().css('display','block');
			$(this).parent().parent().css('background','#d38606');
			$(this).find('a.hs').css('color','#d38606');
			$(this).find('b.triangle-box').css('display','block');
		}); 
			
	 //消息框 	
	 $(".news-box").click(function () {
		if ($(this).css("display")=="block") {
			 $(this).css("display","block");
			 $(".news-body").css("display","block");
		};
	});
	 $(".news-body").click(function () {
		if ($(".news-box").css("display")=="block") {
			$(".news-box").css("display","none");
			$(".news-body").css("display","none");
			$(".news-a").find(".hover-a").attr("src","images/news7.png");
			$(".news-a").find(".hover-b").attr("src","images/news4.png");
			
		}	
		$(".news-a").click(function(){
			if ($(".news-box").css("display")=="block") {
				$(this).find("img").attr("src","images/news4.png"); 
			}
		 });
	});
     
	$(".news-a").click(function () {
		if ($(".news-box").css("display")=="none") {
			$(".news-body").css("display","block");
			$(".news-box").css("display","block");
			$(this).find("img").attr("src","images/news4.png");
		}
		//event.stopPropagation();
		 
	});
	
});
		

	</script>


</body>
</html>